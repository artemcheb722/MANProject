<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>

<style>

body {
    background: #f5f7fa;
    font-family: "Inter", Arial, sans-serif;
    color: #333;
}

.project-detail-container {
    max-width: 1200px;
    margin: 40px auto;
    padding: 0 20px;
}


.back-btn {
    display: inline-block;
    margin-bottom: 20px;
    text-decoration: none;
    color: #007bff;
    font-weight: 600;
}


.project-header h1 {
    font-size: 32px;
    margin-bottom: 10px;
    font-weight: 700;
}

.project-meta {
    display: flex;
    gap: 20px;
    color: #777;
}


.project-body {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 30px;
    margin-top: 30px;
}


.carousel-img {
    border-radius: 12px;
    max-height: 450px;
    object-fit: cover;
}


.content-block {
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    margin-top: 25px;
}


.tech-category-container {
    display: flex;
    gap: 20px;
    margin-top: 20px;
}

.tech-category-item {
    flex: 1;
    background: #fff;
    padding: 18px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}


.reviews {
    margin-top: 30px;
}

.reviews-list {
    list-style: none;
    padding: 0;
    margin-top: 10px;
}

.review-item {
    background: #fff;
    padding: 15px;
    margin-bottom: 12px;
    border-radius: 12px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.05);
}

.review-author {
    font-weight: 600;
    margin-bottom: 5px;
}

.review-time {
    font-size: 14px;
    color: #999;
    margin-top: 4px;
}

.add-review textarea {
    border-radius: 10px;
}

.btn-success {
    border-radius: 10px;
}


.likes-section {
    background: #fff;
    padding: 18px;
    border-radius: 12px;
    margin-top: 25px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}

.toggle-like-btn {
    background: none;
    border: none;
    font-size: 18px;
    cursor: pointer;
}


.project-sidebar {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.author-info {
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
}

.author-avatar {
    width: 110px;
    height: 110px;
    object-fit: cover;
    border-radius: 50%;
    margin-bottom: 10px;
}

.cta-btn {
    display: inline-block;
    margin-top: 10px;
    padding: 10px 14px;
    background: #007bff;
    color: #fff;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 600;
}


@media (max-width: 900px) {
    .project-body {
        grid-template-columns: 1fr;
    }
    .tech-category-container {
        flex-direction: column;
    }
}
</style>
</head>
<body>

<main class="project-detail-container">

    <a href="{{ url_for('index') }}" class="back-btn">
        ‚¨Ö –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –Ω–∞ –≥–æ–ª–æ–≤–Ω—É
    </a>

    <div class="project-header">
        <h1>{{ project.project_name }}</h1>
        <div class="project-meta">
            <div class="meta-item">
                <strong>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</strong> {{ project.category }}
            </div>
            <div class="meta-item">
                <strong>–°—Ç–≤–æ—Ä–µ–Ω–æ:</strong> {{ project.created_at|naturaltime }}
            </div>
        </div>
    </div>

    <div class="project-body">
        <div class="project-gallery">

            <div id="carouselRestaurant" class="carousel slide" data-bs-ride="carousel">

                {% if project.images|length > 1 %}
                    <div class="carousel-indicators">
                        {% for i in range(project.images|length) %}
                            <button type="button" data-bs-target="#carouselProject"
                                    data-bs-slide-to="{{ i }}"
                                    class="{% if loop.first %}active{% endif %}"
                                    aria-label="Slide {{ i+1 }}"></button>
                        {% endfor %}
                    </div>
                {% endif %}


                <div class="carousel-inner">
                    {% for image in project.images %}
                        <div class="carousel-item {% if loop.first %}active{% endif %}">
                            <img src="{{ image }}" class="d-block w-100 carousel-img" alt="–§–æ—Ç–æ –ø—Ä–æ–µ–∫—Ç—É">
                        </div>
                    {% endfor %}
                </div>


                {% if project.images|length > 1 %}
                    <button class="carousel-control-prev" type="button" data-bs-target="#carouselRestaurant"
                            data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">–ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#carouselRestaurant"
                            data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">–ù–∞—Å—Ç—É–ø–Ω–∏–π</span>
                    </button>
                {% endif %}
            </div>

            <section class="content-block">
                <h3>–û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É</h3>
                <p>{{ project.detailed_description }}</p>
            </section>

            <div class="tech-category-container">
                <section class="tech-category-item">
                    <h4>üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó</h4>
                    <p>{{ project.technologies }}</p>
                </section>

                <section class="tech-category-item">
                    <h4>üìÅ –ö–∞—Ç–µ–≥–æ—Ä—ñ—è</h4>
                    <p>{{ project.category }}</p>
                </section>
            </div>

            <div class="reviews">
                <h3>üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ</h3>
                {% if comments %}
                    <ul class="reviews-list">
                        {% for comment in comments %}
                            <li class="review-item">
                                <a href="{{ url_for('get_user_profile_by_id', user_id=project.author.id) }}" class="review-author">{{ comment.author }}</a>
                                <div class="review-text">{{ comment.text }}</div>
                                <div class="review-time">{{ comment.created_at|naturaltime }}</div>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-muted">–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ —â–µ –Ω–µ–º–∞—î.</p>
                {% endif %}
            </div>

            {% if request.cookies.access_token %}
                <div class="add-review">
                    <h3>–î–æ–¥–∞—Ç–∏ —Å–≤—ñ–π –∫–æ–º–µ–Ω—Ç–∞—Ä</h3>
                    <form method="post" action="{{ url_for('add_comment', project_id=project.id) }}">
                        <div style="margin-bottom: 20px;">
                            <textarea name="comment_text" class="form-control" rows="4"
                                      placeholder="–ù–∞–ø–∏—à—ñ—Ç—å —Å–≤—ñ–π –∫–æ–º–µ–Ω—Ç–∞—Ä..." required></textarea>
                        </div>
                        <button type="submit" class="btn btn-success">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä</button>
                    </form>
                </div>
            {% else %}
                <div class="alert alert-warning">
                    –©–æ–± –∑–∞–ª–∏—à–∞—Ç–∏ —Å–≤–æ—ó –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ, –±—É–¥—å –ª–∞—Å–∫–∞, <a href="{{ url_for('login') }}"
                                                                style="color: #0078ff; font-weight: 600;">—É–≤—ñ–π–¥—ñ—Ç—å –≤
                    –∞–∫–∞—É–Ω—Ç</a>.
                </div>
            {% endif %}

            <div class="likes-section">
                <h3>–õ–∞–π–∫–∏: <span id="likesCount">{{ project.count_of_likes or 0 }}</span></h3>

                <form method="post" action="/projects/like/{{ project.id }}">
                    <button type="submit" class="toggle-like-btn">
                        {% if user_liked %}
                            ‚ù§Ô∏è –£–±—Ä–∞—Ç—å –ª–∞–π–∫
                        {% else %}
                            ü§ç –ü–æ—Å—Ç–∞–≤–∏—Ç—å –ª–∞–π–∫
                        {% endif %}
                    </button>
                </form>
            </div>
        </div>

        <aside class="project-sidebar">
            <div class="author-info">
                {% if project.author.user_avatar %}
                    <img src="{{ project.author.user_avatar }}" alt="–ê–≤–∞—Ç–∞—Ä {{ project.author.name }}"
                         class="author-avatar">
                {% endif %}

                <h4>{{ project.author.name }}</h4>
                <a href="{{ url_for('get_user_profile_by_id', user_id=project.author.id) }}" class="cta-btn">–ü—Ä–æ—Ñ—ñ–ª—å
                    –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</a>
            </div>

            <section class="content-block">
                <h3>‚ÑπÔ∏è –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h3>
                <p class="project-Additional_information">
                    {% if project.Additional_information %}
                        {{ project.Additional_information }}
                    {% else %}
                        <span class="no-description">–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á —â–µ –Ω–µ –¥–æ–¥–∞–≤ –æ–ø–∏—Å –¥–æ —Ü—å–æ–≥–æ –ø—Ä–æ—î–∫—Ç—É</span>
                    {% endif %}
                </p>
            </section>
        </aside>
    </div>
</main>

</body>
</html>